<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pandas_filter_find_group</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="07_Pandas_Filter_Find_Group_files/libs/clipboard/clipboard.min.js"></script>
<script src="07_Pandas_Filter_Find_Group_files/libs/quarto-html/quarto.js"></script>
<script src="07_Pandas_Filter_Find_Group_files/libs/quarto-html/popper.min.js"></script>
<script src="07_Pandas_Filter_Find_Group_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="07_Pandas_Filter_Find_Group_files/libs/quarto-html/anchor.min.js"></script>
<link href="07_Pandas_Filter_Find_Group_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="07_Pandas_Filter_Find_Group_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="07_Pandas_Filter_Find_Group_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="07_Pandas_Filter_Find_Group_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="07_Pandas_Filter_Find_Group_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<table class="caption-top">
<thead>
<tr class="header">
<th><a href="04_Pandas_Basics.md">Pandas Basics</a></th>
<th><a href="05_Pandas_Clean_Data.md">Clean Data</a></th>
<th><a href="06_Pandas_Tidy_Data.md">Tidy Data</a></th>
<th><strong>Filtering, Finding, and Grouping</strong></th>
<th><a href="08_Pandas_Graphs_and_Charts.md">Graphs and Charts</a></th>
<th><a href="09_Pandas_Networks.md">Networks</a></th>
</tr>
</thead>

</table>
<section id="advanced-pandas-filtering-finding-and-grouping" class="level1">
<h1>Advanced Pandas: Filtering, Finding, and Grouping</h1>
<p>In this tutorial we will explore several key concepts for working with complex datasets:</p>
<ul>
<li><strong>Filters</strong>, which allow you to select a subset of the dataset based on specified conditions</li>
<li><strong>Bins</strong>, which allow you to categorize and organize your data</li>
<li><strong>Groups</strong>, which allow you to perform the same operation on several distinct subsets of your data simultaneously (among other things)</li>
<li>The ways in which <strong>tidy data</strong> is essential for all of these tools</li>
</ul>
<p>Read the official Pandas <a href="https://pandas.pydata.org/about/">documentation</a>.</p>
<p>Find tutorials at <a href="https://www.w3schools.com/python/pandas/default.asp">W3Schools</a>.</p>
<p>A helpful <a href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">Pandas Cheat Sheet</a>.</p>
<p>Contents of this Tutorial</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Contents of this Tutorial</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.</td>
<td><a href="#a-basic-filter"><strong>A Basic Filter</strong></a></td>
</tr>
<tr class="even">
<td>2.</td>
<td><a href="#using-filters"><strong>Using Filters</strong></a></td>
</tr>
<tr class="odd">
<td>3.</td>
<td><a href="#bins-from-continuous-to-categorical-data"><strong>Bins: From Continuous to Categorical Data</strong></a></td>
</tr>
<tr class="even">
<td>4.</td>
<td><a href="#groupby-functions"><strong>Groupby Functions</strong></a></td>
</tr>
</tbody>
</table>
<section id="create-a-notebook-and-load-the-pandas-library" class="level2">
<h2 class="anchored" data-anchor-id="create-a-notebook-and-load-the-pandas-library">Create a Notebook and Load the Pandas Library</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="meet-the-beatles-again" class="level2">
<h2 class="anchored" data-anchor-id="meet-the-beatles-again">Meet the Beatles (Again)</h2>
<p>The Pandas library has a vast array of tools for sorting, filtering, grouping, analyzing, and even visualizing tabluar data of various kinds: strings, booleans, integers, floats, dates, and so on. We begin with data about the albums and songs issued by the Beatles. The data are drawn from two sources:</p>
<ul>
<li><p>A set from <strong>Spotify</strong> that includes information about 193 songs, albums, years, plus other acoustic ratings that Spotify uses to characterize tracks. View these data on<a href="https://github.com/RichardFreedman/Encoding_Music/blob/main/02_Lab_Data/Beatles/M_255_Beatles_Spotify_2025.csv">Github</a>.</p></li>
<li><p>A set compiled by a team at the <strong>University of Belgrade (Serbia)</strong> that contains information about over 300 Beatles songs: author(s), lead singer(s), album, musical genre(s), and standing in the Top 50 Billboard charts. View these data on <a href="'https://github.com/inteligentni/Class-05-Feature-engineering/blob/master/The%20Beatles%20songs%20dataset%2C%20v1%2C%20no%20NAs.csv'">Github</a>.</p></li>
</ul>
<p>We will work with both of these sets, and in the process learn how to inspect, clean, combine, filter, group, and analyze the information they contain.</p>
<p>We give the URL of the CSV file a name (simply for convenience), then pass that name to the <code>read_csv('source_file_name')</code> method, and name the resulting data frame.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>beatles_spotify_csv <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/RichardFreedman/Encoding_Music/refs/heads/main/02_Lab_Data/Beatles/M_255_Beatles_Spotify_2025.csv'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>beatles_spotify <span class="op">=</span> pd.read_csv(beatles_spotify_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard_csv <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/inteligentni/Class-05-Feature-engineering/master/The%20Beatles</span><span class="sc">%20s</span><span class="st">ongs</span><span class="sc">%20d</span><span class="st">ataset%2C%20v1%2C%20no%20NAs.csv'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>beatles_billboard <span class="op">=</span> pd.read_csv(beatles_billboard_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can merge these with <code>pd.merge()</code>. Or just load the combined data from our Encoding Music repository, in this case as a <code>pickle</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>beatles_spotify_pkl <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/RichardFreedman/Encoding_Music/main/02_Lab_Data/Beatles/beatles_data.pkl'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import to a Pandas dataframe</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>beatles_spotify <span class="op">=</span> pd.read_pickle(beatles_spotify_pkl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="a-basic-filter" class="level2">
<h2 class="anchored" data-anchor-id="a-basic-filter">A Basic Filter</h2>
<p>An important feature in Pandas is the ability to look at only rows that meet a desired condition. This is called <strong>filtering</strong>.</p>
<p>To filter, you need to write a <strong>boolean condition</strong> that will be evaluated for each row. Only rows for which this condition is <code>True</code> will be returned.</p>
<p>There are several types of conditions you can create.</p>
<section id="what-is-a-condition" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-condition">What is a condition?</h3>
<p>One example of a condition in plain English:</p>
<blockquote class="blockquote">
<p>“does this row have the value <code>'Abbey Road'</code> in the <code>'Album.debut'</code> column?”</p>
</blockquote>
<p>For every row, this will either be <code>True</code> or <code>False</code>. Let’s take a look at how you would write this condition in Python and Pandas:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">==</span> <span class="st">'Abbey Road'</span>  <span class="co"># &lt;-- this is our condition</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table border="0">
<tbody><tr>
<th valign="top">
Output:
</th>
<td>
<pre>0      False
1      False
2      False
3      False
4      False
       ...  
305    False
306    False
307    False
308    False
309    False
Name: Album.debut, Length: 310, dtype: bool</pre>
</td>
</tr>
</tbody></table>
<p>The result is a Boolean series, where the index for each row in the dataframe is paired with either <code>True</code> or <code>False</code>. It is then possible to apply this Boolean series as a kind of ‘mask’ against the entire dataframe. Only the rows that have been assigned <code>True</code> in our Boolean series will be returned.</p>
</section>
<section id="apply-a-filter" class="level3">
<h3 class="anchored" data-anchor-id="apply-a-filter">Apply a Filter</h3>
<p>To filter the dataframe, you pass this condition to the dataframe within square brackets, like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">==</span> <span class="st">'Abbey Road'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table border="0">
<tbody><tr>
<th valign="top">
Output:
</th>
<td>
<details>
<summary>
Click to show output
</summary>
<table border="1">
<thead>
<tr>
<th>
</th>
<th>
Title
</th>
<th>
Year
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Songwriter
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
27
</th>
<td>
Because
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
165
</td>
<td>
11
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon, McCartney, Harrison
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
36
</th>
<td>
Carry That Weight
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
96
</td>
<td>
5
</td>
<td>
Symphonic Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney, with Lennon, Harrison and Starkey
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
45
</th>
<td>
Come Together
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
258
</td>
<td>
17
</td>
<td>
Blues Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
6
</td>
</tr>
<tr>
<th>
81
</th>
<td>
Golden Slumbers
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
91
</td>
<td>
5
</td>
<td>
Rock, Baroque Pop, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
94
</th>
<td>
Her Majesty
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
23
</td>
<td>
8
</td>
<td>
Music Hall, Folk, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
95
</th>
<td>
Here Comes the Sun
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
186
</td>
<td>
6
</td>
<td>
Folk Pop, Pop/Rock
</td>
<td>
Harrison
</td>
<td>
Harrison
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
120
</th>
<td>
I Want You (She’s So Heavy)
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
467
</td>
<td>
5
</td>
<td>
Blues Rock, Hard Rock, Progressive Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
178
</th>
<td>
Maxwell’s Silver Hammer
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
207
</td>
<td>
8
</td>
<td>
Rock, Music Hall, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
179
</th>
<td>
Mean Mr.&nbsp;Mustard
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
66
</td>
<td>
6
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
195
</th>
<td>
Octopus’s Garden
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
168
</td>
<td>
10
</td>
<td>
Rock, Pop/Rock
</td>
<td>
Starkey, with uncredited assistance from Harrison
</td>
<td>
Starkey
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
196
</th>
<td>
Oh! Darling
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
206
</td>
<td>
9
</td>
<td>
Swamp Pop, Hard Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
208
</th>
<td>
Polythene Pam
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
72
</td>
<td>
8
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
226
</th>
<td>
She Came in Through the Bathroom Window
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
117
</td>
<td>
6
</td>
<td>
Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
237
</th>
<td>
Something
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
179
</td>
<td>
16
</td>
<td>
Rock, Pop/Rock
</td>
<td>
Harrison
</td>
<td>
Harrison
</td>
<td>
30
</td>
</tr>
<tr>
<th>
241
</th>
<td>
Sun King
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
146
</td>
<td>
6
</td>
<td>
Art Pop, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
256
</th>
<td>
The End
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
140
</td>
<td>
6
</td>
<td>
Hard Rock, Art Rock, Heavy Metal, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
302
</th>
<td>
You Never Give Me Your Money
</td>
<td>
1969
</td>
<td>
Abbey Road
</td>
<td>
242
</td>
<td>
7
</td>
<td>
Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
</tr>
</tbody>
</table>
</details>
</td>
</tr>
</tbody></table>
</section>
<section id="ensuring-success-with-filters" class="level3">
<h3 class="anchored" data-anchor-id="ensuring-success-with-filters">Ensuring Success with Filters</h3>
<p>Filters can easily cause errors if you try to perform operations that Python and Pandas can’t interpret. There are two key things to be aware of when filtering:</p>
<ul>
<li><strong>Fix missing data.</strong> Operations on missing data often don’t work, so if your condition will reference any missing data, problems may occur.</li>
<li><strong>Fix data types</strong>. If you try to perform a numerical comparison on data stored as a string, for example, you will also get errors.</li>
</ul>
<p>In other words, remember to clean your data! <a href="05_Pandas_Clean_Data.md">Pandas: Clean Data</a> and <a href="06_Pandas_Tidy_Data.md">Pandas: Tidy Data</a> will help you.</p>
</section>
<section id="saving-a-filtered-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="saving-a-filtered-dataframe">Saving a Filtered DataFrame</h3>
<p>If you want to save a filtered dataframe, just assign it to a variable! If you want it to replace your original dataframe, you can use the same name:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard <span class="op">=</span> beatles_billboard[beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">==</span> <span class="st">'Abbey Road'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="using-filters" class="level2">
<h2 class="anchored" data-anchor-id="using-filters">Using Filters</h2>
<p>Filtering can be much more powerful than searching for an exact match. Here are some other <strong>types of filters</strong>.</p>
<section id="filters-on-numerical-data" class="level3">
<h3 class="anchored" data-anchor-id="filters-on-numerical-data">Filters on Numerical Data</h3>
<p>You can compare value in a certain column to a given value, or even a value in another column. For example, to check whether an album was released after 1969, use the condition <code>beatles_billboard['Year'] &gt; 1969</code>. In a filter, that would be:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[beatles_billboard[<span class="st">'Year'</span>] <span class="op">&gt;</span> <span class="dv">1969</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can use any numerical operator in Python (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>).</p>
<p>We can even <em>invert</em> the Boolean values, thus returning a dataframe that contains all rows <em>except</em> those matching the given condition. We do this use the negation operator <code>~</code>, and surrounding the original condition with parentheses <code>()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="op">~</span>(beatles_billboard[<span class="st">'Year'</span>] <span class="op">&gt;</span> <span class="dv">1964</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="searching-for-strings-and-substrings" class="level3">
<h3 class="anchored" data-anchor-id="searching-for-strings-and-substrings">Searching for Strings and SubStrings</h3>
<p>To search for strings within a column, there are two methods:</p>
<ul>
<li><code>str.contains()</code>, which checks whether a cell contains the given substring</li>
<li><code>.contains("str1 | str2 | str3")</code>, which checks whether the cell contents contain any string in the given list</li>
</ul>
<section id="the-str.contains-method" class="level4">
<h4 class="anchored" data-anchor-id="the-str.contains-method">The <code>str.contains()</code> Method</h4>
<p>For example here we filter to tracks with <code>'Anthology'</code> in the <code>'Album.debut'</code> column. The condition we use is:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Album.debut'</span>].<span class="bu">str</span>.contains(<span class="st">'Anthology'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As long as the album name contains <code>'Anthology'</code>, it will pass the condition. This means the albums <code>'Anthology 1'</code>, <code>'Anthology 2'</code>, and <code>'Anthology 3'</code> will all pass.</p>
<p>Now apply the filter:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[beatles_billboard[<span class="st">'Album.debut'</span>].<span class="bu">str</span>.contains(<span class="st">'Anthology'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table border="0">
<tbody><tr>
<th valign="top">
Output:
</th>
<td>
<details>
<summary>
Click to show output (first 3 rows only)
</summary>
<table border="1">
<thead>
<tr>
<th>
</th>
<th>
Title
</th>
<th>
Year
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Songwriter
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
12-Bar Original
</td>
<td>
1965
</td>
<td>
Anthology 2
</td>
<td>
174
</td>
<td>
0
</td>
<td>
Blues
</td>
<td>
Lennon, McCartney, Harrison and Starkey
</td>
<td>
NaN
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
7
</th>
<td>
Ain’t She Sweet
</td>
<td>
1961
</td>
<td>
Anthology 1
</td>
<td>
150
</td>
<td>
9
</td>
<td>
Pop/Rock
</td>
<td>
Yellen, Ager
</td>
<td>
Lennon
</td>
<td>
41
</td>
</tr>
<tr>
<th>
10
</th>
<td>
All Things Must Pass
</td>
<td>
1969
</td>
<td>
Anthology 3
</td>
<td>
227
</td>
<td>
0
</td>
<td>
Folk Rock, Pop/Rock
</td>
<td>
Harrison
</td>
<td>
Harrison
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
</tbody>
</table>
</details>
</td>
</tr>
</tbody></table>
<p><br></p>
<blockquote class="blockquote">
<p>This is an example of a filter that <strong>will not work</strong> if your data has not first been cleaned! There are some entries missing in the <code>'Album.debut'</code> column. Some suggestions to fix this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace missing values with the text "unreleased"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">=</span> beatles_billboard[<span class="st">'Album.debut'</span>].fillna(<span class="st">'unreleased'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop rows with missing values</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">=</span> beatles_billboard[<span class="st">'Album.debut'</span>].dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>&nbsp;</p>
</blockquote>
</section>
<section id="using-.contains-with-multiple-strings" class="level4">
<h4 class="anchored" data-anchor-id="using-.contains-with-multiple-strings">Using <code>.contains</code> with multiple strings</h4>
<p>To create a filter that checks if the column contains one string <strong>OR</strong> another, you can use <code>.contains("string1 | string2")</code>. Make sure that the <code>|</code> (which means or) is within the parentheses.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Lennon_or_McCartney <span class="op">=</span> genre_counts[genre_counts[<span class="st">'songwriter'</span>].<span class="bu">str</span>.contains(<span class="st">"Lennon | McCartney"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-.isin-method" class="level4">
<h4 class="anchored" data-anchor-id="the-.isin-method">The <code>.isin()</code> Method</h4>
<p>The <code>.isin()</code> method works if you are looking for cells that match <em>at least one of several</em> possible strings. Note that the strings must be presented as a “list”, thus <code>isin(["string_1", "string_2"])</code>. For example, to return rows that have just “Lennon” OR just “McCartney”:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[beatles_billboard[<span class="st">'Songwriter'</span>].isin([<span class="st">"Lennon"</span>, <span class="st">"McCartney"</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="filtering-with-multiple-conditions" class="level3">
<h3 class="anchored" data-anchor-id="filtering-with-multiple-conditions">Filtering with Multiple Conditions</h3>
<p>You can filter with several conditions at once using <strong>logical operators</strong>. Surround your conditions with parentheses and place a logical operator between them, e.g.&nbsp;<code>(condition1) &amp; (condition2)</code>. You can use any of the following operators:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operator</th>
<th>Name</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&amp;</code></td>
<td>and</td>
<td>Both conditions must be true</td>
</tr>
<tr class="even">
<td><code>\|</code></td>
<td>or</td>
<td>Either (or both) conditions must be true</td>
</tr>
</tbody>
</table>
<p>As an example, you can filter for tracks both from one of the “Anthology” albums <strong>and</strong> released before 1965:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[(beatles_billboard[<span class="st">'Album.debut'</span>].<span class="bu">str</span>.contains(<span class="st">'Anthology'</span>)) <span class="op">&amp;</span> (beatles_billboard[<span class="st">'Year'</span>] <span class="op">&lt;</span> <span class="dv">1965</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="bins-from-continuous-to-categorical-data" href=""></a> ## Bins: From Continuous to Categorical Data</p>
<p>Another important tool is being able to categorize data. Oftentimes, this is done through “binning” – assigning the entry to one of several discrete categories based on some continuous value.</p>
</section>
<section id="boolean-bins" class="level3">
<h3 class="anchored" data-anchor-id="boolean-bins">Boolean Bins</h3>
<p>In the following example, we will use the values in the <code>"danceability"</code> column (expressed as floats ranging from <code>0</code> to <code>1</code>) to classify a track as a Dance Tune (<code>0</code> =&gt; Not a Dance Tune; <code>1</code> =&gt; Definitely a Dance Tune).</p>
<p>Here we are using the <em>beatles_spotify</em> data:</p>
<p>First, you need to think about picking a certain threshold value. Is Get Back by the Beatles (0.628 danceability rating) a Dance Tune? How about Doctor Robert (0.392 danceability score)? Use the code cell below to <strong>pick your danceability threshold value</strong> and save it as a variable.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>beatles_spotify.loc[beatles_spotify[<span class="st">"danceability"</span>].astype(<span class="bu">float</span>).between(<span class="fl">0.000</span>, <span class="fl">0.500</span>, <span class="st">"right"</span>), <span class="st">"Dance Tune"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>beatles_spotify.loc[beatles_spotify[<span class="st">"danceability"</span>].astype(<span class="bu">float</span>).between(<span class="fl">0.501</span>, <span class="fl">1.000</span>, <span class="st">"right"</span>), <span class="st">"Dance Tune"</span>] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now we have a new column <code>'Dance Tune'</code> with a value of <code>1.0</code> if the track <em>is</em> a dance tune, and a value of <code>0.0</code> if the value is <em>not</em> a dance tune.</p>
</section>
<section id="categorical-bins" class="level3">
<h3 class="anchored" data-anchor-id="categorical-bins">Categorical Bins</h3>
<p>Sometimes, a simple True/False ranking isn’t enough. For example, the “tempo” column provides the Beat Per Minute musical tempo value for a given track; this value typically ranges between 1 and ~500 bpm. While it is possible to classify tracks into Slow and Not Slow, it might be more useful to, for example, categorize them into “Slow”, “Medium”, and “Fast”.</p>
<section id="cut-and-qcut-creating-categorical-bins-automatically" class="level4">
<h4 class="anchored" data-anchor-id="cut-and-qcut-creating-categorical-bins-automatically"><code>cut</code> and <code>qcut</code>: Creating Categorical Bins Automatically</h4>
<p>Pandas provides two powerful methods for putting scalar data into bins, and (in turn) labeling the bins as part of the dataframe.</p>
<p>The <code>cut</code> method will divide your scalar data into “n” bins, with each bin representing an <strong>equal segment of your original range</strong>. There are several parameters and options that allow you do deal with special cases. In the code below, we set <code>include_lowest=True</code> so that the ‘items representing the lowest’ of each bin boundary are include in the relevant bin. Read the <a href="https://pandas.pydata.org/docs/reference/api/pandas.cut.html">Pandas Cut Documentation</a>.</p>
<p>The bins are of equal size, but contain different numbers of items:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here the spans of the buckets are the same, but they have different numbers of items in them</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>binned_data <span class="op">=</span> pd.cut(beatles_spotify[<span class="st">"danceability"</span>], bins<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s use <code>.value_counts()</code> and <code>.sort_index()</code> to see the number of entries in each bin, sorted by the range of the bin:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>binned_data.value_counts().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table border="0">
<tbody><tr>
<th valign="top">
Output:
</th>
<td>
<pre>danceability
(0.145, 0.33]     19
(0.33, 0.513]     62
(0.513, 0.696]    93
(0.696, 0.88]     19
Name: count, dtype: int64</pre>
</td>
</tr>
</tbody></table>
<p>The <code>qcut</code> method takes the distribution (and not just the range) of your data into account. With this method, Pandas will create categories in which there is are an <strong>equal number of items</strong> in each range. For example if we asked for 5 bins, and if 80% of your values are equally distributed in the lowest 40% of your range, we might expect to see four ‘bands’ for that range, and only one band for the remaining band (that is: five bands in all, each with the same number of items in it).</p>
<p>Here the bins are of different size, but contain equal numbers of items:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># each bin will have the same proportion of items in it</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>q_binned <span class="op">=</span> pd.qcut(our_data[<span class="st">"danceability"</span>], q<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s check the output:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>q_binned.value_counts().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table border="0">
<tbody><tr>
<th valign="top">
Output:
</th>
<td>
<pre>danceability
(0.145, 0.419]    49
(0.419, 0.533]    48
(0.533, 0.612]    48
(0.612, 0.88]     48
Name: count, dtype: int64</pre>
</td>
</tr>
</tbody></table>
</section>
<section id="adding-labels-to-the-bins" class="level4">
<h4 class="anchored" data-anchor-id="adding-labels-to-the-bins">Adding Labels to the Bins</h4>
<p>It’s also possible to add labels to each of these bins as you create them.</p>
<p>With <code>cut</code> method:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>binned_data <span class="op">=</span> pd.cut(beatles_spotify[<span class="st">"danceability"</span>], bins<span class="op">=</span><span class="dv">4</span>, labels<span class="op">=</span>[<span class="st">'l'</span>, <span class="st">'m'</span>, <span class="st">'h'</span>, <span class="st">'s'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With <code>qcut</code> method:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>binned_data <span class="op">=</span> pd.qcut(beatles_spotify[<span class="st">"danceability"</span>], q<span class="op">=</span><span class="dv">4</span>, labels<span class="op">=</span>[<span class="st">'l'</span>, <span class="st">'m'</span>, <span class="st">'h'</span>, <span class="st">'s'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The results are each a Series. You can assign these binned (and labelled) categories back to a column in the original dataframe. For example:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>beatles_spotify[<span class="st">'dance_binned'</span>] <span class="op">=</span> pd.qcut(beatles_spotify[<span class="st">"danceability"</span>], q<span class="op">=</span><span class="dv">4</span>, labels<span class="op">=</span>[<span class="st">'l'</span>, <span class="st">'m'</span>, <span class="st">'h'</span>, <span class="st">'s'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="groupby-functions" class="level2">
<h2 class="anchored" data-anchor-id="groupby-functions">Groupby Functions</h2>
<p><code>groupby</code> is a powerful method that saves time when working with subsets (groups) of your data that share a certain characteristic. Some of its most important use cases are compiling statistics for several subsets of your data, simultaneously and creating graphs based on those subsets.</p>
<p>However, <code>groupby</code> also requires special attention to the tidiness of your data in order for it to function correctly.</p>
<p>There will be a supplemental essay on groupby functions available on Moodle or GDrive. That will be a more in-depth view of the topic, whereas the below guide to groupby focuses on some of the core features.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>In this section</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.</td>
<td><a href="#cleaning-data-for-groupby"><strong>Cleaning Data for groupby</strong></a></td>
</tr>
<tr class="even">
<td>2.</td>
<td><a href="#introduction-to-groupby"><strong>Introduction to groupby</strong></a></td>
</tr>
<tr class="odd">
<td>3.</td>
<td><a href="#additional-examples-using-groupby"><strong>Additional Examples using groupby</strong></a></td>
</tr>
<tr class="even">
<td>4.</td>
<td><a href="#groupby-functions"><strong>Groupby Functions</strong></a></td>
</tr>
<tr class="odd">
<td>5.</td>
<td><a href="#working-with-a-single-group"><strong>Working With a Single Group</strong></a></td>
</tr>
<tr class="even">
<td>6.</td>
<td><a href="#more-ways-to-use-groupby"><strong>More ways to use groupby</strong></a></td>
</tr>
</tbody>
</table>
<p><a name="cleaning-data-for-groupby" href=""></a> ### Cleaning Data for groupby</p>
<p>When you use groupby, you choose a <em>grouping column</em>. In the example below, we will use the ‘Album.debut’ column. This column is easy to work with, since (almost) every track has exactly one album; each row had exactly one <em>group name</em> (the album title).</p>
<p>This is not always the case, and for this reason you may have to tidy your data before being able to group it. Consider the following example:</p>
<p>Imagine you want to group by genre. Consider the song “Golden Slumbers”, which has the genre ‘Rock, Baroque Pop, Pop/Rock’. Our ideal result is that Golden Slumbers is placed into three groups: one group for ‘Rock’, one for ‘Baroque Pop’, and one for ‘Pop/Rock’. However, if we try to group by genre without tidying the data, Golden Slumbers will be placed into a ‘Rock, Baroque Pop, Pop/Rock’ group, containing only songs with identical genres, written in the same order. How can we fix this? Using explode!</p>
<p>As you learned in <a href="06_Pandas_Tidy_Data.md">Pandas: Tidy Data</a>, you can explode a column containing several observations into several rows, each containing a single observation (e.g.&nbsp;one genre).</p>
<p>Code to explode genre</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean the data before exploding</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard[<span class="st">'Genre'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.strip().fillna(<span class="st">''</span>).<span class="bu">str</span>.split(<span class="st">', '</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># explode the data</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded <span class="op">=</span> beatles_billboard.explode(<span class="st">'Genre'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># clean individual problems in the exploded data with str.replace() and str.strip()</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.strip(<span class="st">'['</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">'pop/rock'</span>, <span class="st">'pop rock'</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">'r&amp;b'</span>, <span class="st">'rhythm and blues'</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">'rock and roll'</span>, <span class="st">'rock'</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">'experimental music'</span>, <span class="st">'experimental'</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">"children's music"</span>, <span class="st">"children's"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>beatles_billboard_exploded[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard_exploded[<span class="st">'Genre'</span>].<span class="bu">str</span>.replace(<span class="st">"stage&amp;screen"</span>, <span class="st">"stage and screen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You could also clean the data with a a dictionary and map, as we explained in the <a href="05_Pandas_Clean_Data.md">Pandas: Clean Data</a> tutorial</p>
<p>The result for Golden Slumbers would look like this:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th>Title</th>
<th>Year</th>
<th>Album.debut</th>
<th>Duration</th>
<th>Other.releases</th>
<th>Genre</th>
<th>Songwriter</th>
<th>Lead.vocal</th>
<th>Top.50.Billboard</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">154</td>
<td>Golden Slumbers</td>
<td>1969</td>
<td>Abbey Road</td>
<td>91</td>
<td>5</td>
<td>rock</td>
<td>McCartney</td>
<td>McCartney</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">155</td>
<td>Golden Slumbers</td>
<td>1969</td>
<td>Abbey Road</td>
<td>91</td>
<td>5</td>
<td>baroque pop</td>
<td>McCartney</td>
<td>McCartney</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">156</td>
<td>Golden Slumbers</td>
<td>1969</td>
<td>Abbey Road</td>
<td>91</td>
<td>5</td>
<td>pop/rock</td>
<td>McCartney</td>
<td>McCartney</td>
<td>-1</td>
</tr>
</tbody>
</table>
<p>Now, when you use groupby on the ‘Genre’ column, Golden Slumbers will be correctly placed into three groups: ‘rock’, ‘baroque pop’, and ‘pop/rock’.</p>
<p>This example demonstrates the importance of tidying your data whenever appropriate for a specific operation (like groupby). Your <em>grouping column</em> should contain exactly one <em>group name</em> per row. Refer to the techniques in <a href="05_Pandas_Clean_Data.md">Pandas: Clean Data</a> and <a href="06_Pandas_Tidy_Data.md">Pandas: Tidy Data</a> for instructions and examples.</p>
<section id="introduction-to-groupby" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-groupby">Introduction to groupby</h3>
<p>In order to use groupby, you need:</p>
<ul>
<li>A <em>grouping column</em> (or several!)
<ul>
<li>For example, if you want to find the number of songs in each album, you would group by album.<br>
</li>
</ul></li>
<li>Each row in the <em>grouping column</em> should contain exactly one <em>group name</em> (i.e.&nbsp;a clean and tidy dataset, more on this later)
<ul>
<li>In this case, we don’t want one song to have multiple albums in the same row. If a song is in multiple albums, we would want to explode the data first to make sure it gets counted in both.</li>
</ul></li>
</ul>
<section id="basic-syntax-and-output" class="level4">
<h4 class="anchored" data-anchor-id="basic-syntax-and-output">Basic Syntax and Output</h4>
<p>Perform the groupby operation:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> beatles_billboard.groupby(<span class="st">'Album.debut'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The result of the groupby operation has been stored in the variable grouped. But be careful! The result is called a “groupby object” - not a dataframe, but a collection of several dataframes, one for each group. This is more difficult to represent visually, and in fact Pandas won’t display grouped when you just use the variable name:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output:</p>
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f902dd15300&gt;</code></pre>
<p>One way to get around this is using <code>.value_counts()</code>, or an aggregate function like <code>.mean()</code>, depending on what you’re looking for. There is a longer list of aggregate functions you can use to analyze your data below. Since almost every item is unique, when displaying the number of occurrences of each item, <code>.value_counts()</code> will display each distinct item, with just 1 occurrence as noted in the far-right column.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>grouped.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut                                        Title                           Year  Duration  Other.releases  Genre                                  Songwriter              Lead.vocal                                    Top.50.Billboard
Abbey Road                                         Because                         1969  165       11              Pop/Rock                               Lennon                  Lennon, McCartney, Harrison                   -1                  1
                                                   Carry That Weight               1969  96        5               Symphonic Rock, Pop/Rock               McCartney               McCartney, with Lennon, Harrison and Starkey  -1                  1
                                                   Come Together                   1969  258       17              Blues Rock, Pop/Rock                   Lennon                  Lennon                                         6                  1
                                                   Golden Slumbers                 1969  91        5               Rock, Baroque Pop, Pop/Rock            McCartney               McCartney                                     -1                  1
                                                   Her Majesty                     1969  23        8               Music Hall, Folk, Pop/Rock             McCartney               McCartney                                     -1                  1
                                                                                                                                                                                                                                                   ..
UK: With the Beatles US: The Beatles Second Album  You've Really Got a Hold on Me  1963  182       2               Soul, Pop/Rock                         Robinson                Lennon and Harrison                           -1                  1
Yellow Submarine                                   All Together Now                1967  130       8               Skiffle, Pop/Rock                      McCartney, with Lennon  McCartney, with Lennon                        -1                  1
                                                   Hey Bulldog                     1968  194       12              Psychedelic Rock, Hard Rock, Pop/Rock  Lennon                  Lennon                                        -1                  1
                                                   It's All Too Much               1967  388       11              Psychedelic Rock, Acid Rock, Pop/Rock  Harrison                Harrison                                      -1                  1
                                                   Only a Northern Song            1967  207       9               Psychedelic Rock, Pop/Rock             Harrison                Harrison                                      -1                  1
Name: count, Length: 282, dtype: int64</code></pre>
</details>
</section>
<section id="examples-of-aggregate-functions-to-follow-groupby" class="level4">
<h4 class="anchored" data-anchor-id="examples-of-aggregate-functions-to-follow-groupby">Examples of Aggregate Functions to Follow Groupby</h4>
<p>An aggregate function is a function that is applied to a group of data and returns a value. So, using an aggregate function after <code>.groupby()</code> will return one value for each <em>group</em> that <code>.groupby()</code> created.</p>
<p>If you’re confused by any of these or want to see sample output for our object above, see the examples of many of these in <a href="#using-our-aggregate-functions-to-work-with-all-groups">these examples</a> below. It’s worth noting that most of these simple aggregation functions work for quantitative data - see <a href="#more-ways-to-use-groupby">More Ways to Use Groupby</a> for more information on how to display qualitative data. Also see <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.agg.html">Pandas documentation</a> for agg, to use aggregation functions with different columns or to aggregate using one or more operations over the specified axis.</p>
<ul>
<li><code>.count()</code> – Counts non-null values in each group.<br>
</li>
<li><code>.size()</code> – Returns the size (number of rows) of each group, including nulls.<br>
</li>
<li><code>.sum()</code> – Computes the sum of values for each group.<br>
</li>
<li><code>.mean()</code> – Calculates the mean (average) of values for each group.<br>
</li>
<li><code>.median()</code> – Computes the median of values for each group.<br>
</li>
<li><code>.min()</code> / <code>.max()</code> – Finds the minimum or maximum value in each group.<br>
</li>
<li><code>.std()</code> – Calculates the standard deviation of values for each group.<br>
</li>
<li><code>.var()</code> – Computes the variance of values for each group.<br>
</li>
<li><code>.sem()</code> – Calculates the standard error of the mean for each group.<br>
</li>
<li><code>.nunique()</code> – Counts the number of unique values in each group.<br>
</li>
<li><code>.first()</code> / <code>.last()</code> – Returns the first or last value in each group.<br>
</li>
<li><code>.nth(n)</code> – Retrieves the nth value in each group.<br>
</li>
<li><code>.describe()</code> – Generates descriptive statistics for each group, including count, mean, std, min, 25%, 50%, 75%, and max.</li>
</ul>
</section>
<section id="a-brief-example" class="level4">
<h4 class="anchored" data-anchor-id="a-brief-example">A Brief Example</h4>
<p>Imagine you want to find the average duration of tracks in the album “Help!”. Without groupby, you’d write something like:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard[beatles_billboard[<span class="st">'Album.debut'</span>] <span class="op">==</span> <span class="st">'Help!'</span>][<span class="st">'Duration'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><em><code>.mean()</code> returns the average of all the values in a numerical column</em></li>
</ul>
<p>This is perfectly good, concise code. But what if you want to find the average duration of <em>every</em> album? You would have to find all the album names, filter for each of them one at a time, then compute the average for each - not a trivial task!</p>
<p>Instead, you can use <code>.groupby()</code> to separate your data into groups. Pandas can then apply the same operation to each group individually. In one line, this would be:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard.groupby(<span class="st">'Album.debut'</span>)[<span class="st">'Duration'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         166.411765
Anthology 1                                                        147.619048
Anthology 2                                                        181.250000
Anthology 3                                                        181.222222
Help!                                                              146.285714
Let It Be                                                          175.750000
Let It Be... Naked - Fly on the Wall bonus disc                    176.000000
Live at the BBC                                                    137.548387
Live! at the Star-Club in Hamburg, Germany; 1962                   150.000000
Magical Mystery Tour                                               200.000000
On Air - Live at the BBC Volume 2                                  109.000000
Revolver                                                           150.181818
Rock 'n' Roll Music                                                153.000000
Rubber Soul                                                        150.800000
Sgt. Pepper's Lonely Hearts Club Band                              182.769231
The Beatles                                                        185.266667
The Beatles Bootleg Recordings 1963                                117.000000
The Beatles' Christmas Album                                       183.000000
UK: 1967-1970 US: Hey Jude                                         226.333333
UK: A Collection of Beatles Oldies US: 1962-1966                   116.000000
UK: A Collection of Beatles Oldies US: Beatles '65                 145.000000
UK: A Collection of Beatles Oldies US: Beatles VI                  150.000000
UK: A Collection of Beatles Oldies US: Hey Jude                    138.000000
UK: A Collection of Beatles Oldies US: Meet The Beatles!           144.000000
UK: A Collection of Beatles Oldies US: The Beatles Second Album    138.000000
UK: A Collection of Beatles Oldies US: Yesterday and Today         152.500000
UK: A Hard Day's Night US: 1962-1966                               152.000000
UK: A Hard Day's Night US: Beatles '65                             140.000000
UK: A Hard Day's Night US: Hey Jude                                147.500000
UK: A Hard Day's Night US: Something New                           137.500000
UK: A Hard Day's Night US: The Beatles Second Album                157.000000
UK: Beatles for Sale US: Beatles '65                               141.875000
UK: Beatles for Sale US: Beatles VI                                145.500000
UK: Help! US: Beatles VI                                           152.000000
UK: Help! US: Rubber Soul                                          121.000000
UK: Help! US: Yesterday and Today                                  131.000000
UK: Past Masters Volume 1 US: The Beatles Second Album             126.500000
UK: Please Please Me US: Meet The Beatles!                         175.000000
UK: Please Please Me US: Rarities                                  108.000000
UK: Please Please Me US: The Early Beatles                         141.181818
UK: Rarities US: Beatles '65                                       183.000000
UK: Rarities US: Beatles VI                                        161.000000
UK: Rarities US: Hey Jude                                          179.000000
UK: Rarities US: Meet The Beatles!                                 133.000000
UK: Rarities US: Rarities                                          185.333333
UK: Rarities US: Something New                                     146.000000
UK: Rarities US: The Beatles Second Album                          121.000000
UK: Revolver US: Yesterday and Today                               146.000000
UK: Rock 'n' Roll Music US: Something New                          146.000000
UK: Rock 'n' Roll Music US: The Beatles Second Album               130.000000
UK: Rubber Soul US: Yesterday and Today                            156.250000
UK: With the Beatles US: Meet The Beatles!                         128.555556
UK: With the Beatles US: The Beatles Second Album                  164.000000
Yellow Submarine                                                   229.750000
Name: Duration, dtype: float64</code></pre>
</details>
<p><br></p>
<p>If you wanted to round your result, you could use .round() after .mean() with a specified number of decimal points.</p>
<p>Pandas Tutor provides an excellent visualization of this with a subset of the data (just a few columns and albums) <a href="https://pandastutor.com/vis.html#code=import%20pandas%20as%20pd%0Aimport%20io%0A%0Acsv%20%3D%20'''%0ATitle,Album.debut,Duration%0AAnother%20Girl,Help!,124%0AEleanor%20Rigby,Revolver,128%0AFor%20No%20One,Revolver,121%0AGirl,Rubber%20Soul,153%0AGood%20Day%20Sunshine,Revolver,129%0AGot%20to%20Get%20You%20into%20My%20Life,Revolver,147%0AHelp!,Help!,138%0A%22Here,%20There%20and%20Everywhere%22,Revolver,145%0AI%20Need%20You,Help!,148%0AI%20Want%20to%20Tell%20You,Revolver,149%0AI'm%20Looking%20Through%20You,Rubber%20Soul,147%0AIn%20My%20Life,Rubber%20Soul,148%0ALove%20You%20To,Revolver,181%0AMichelle,Rubber%20Soul,160%0ANorwegian%20Wood%20%28This%20Bird%20Has%20Flown%29,Rubber%20Soul,125%0ARun%20for%20Your%20Life,Rubber%20Soul,138%0AShe%20Said%20She%20Said,Revolver,157%0ATaxman,Revolver,159%0AThe%20Night%20Before,Help!,153%0AThe%20Word,Rubber%20Soul,161%0AThink%20for%20Yourself,Rubber%20Soul,138%0ATicket%20to%20Ride,Help!,190%0ATomorrow%20Never%20Knows,Revolver,178%0AWait,Rubber%20Soul,136%0AYellow%20Submarine,Revolver,158%0AYou%20Won't%20See%20Me,Rubber%20Soul,202%0AYou're%20Going%20to%20Lose%20That%20Girl,Help!,140%0AYou've%20Got%20to%20Hide%20Your%20Love%20Away,Help!,131%0A'''%0A%0Asongs%20%3D%20pd.read_csv%28io.StringIO%28csv%29%29%0Asongs%20%3D%20songs%5B%5B'Title',%20'Album.debut',%20'Duration'%5D%5D.sort_values%28'Album.debut'%29%0A%0Asongs.groupby%28'Album.debut'%29%5B'Duration'%5D.mean%28%29&amp;d=2024-07-26&amp;lang=py&amp;v=v1">here</a>. Copy and paste the code snippet below if it does not automatically load in.</p>
<details>
<summary>
Code snippet for Pandas Tutor
</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>csv <span class="op">=</span> <span class="st">'''</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">Title,Album.debut,Duration</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">Another Girl,Help!,124</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st">Eleanor Rigby,Revolver,128</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="st">For No One,Revolver,121</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="st">Girl,Rubber Soul,153</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st">Good Day Sunshine,Revolver,129</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st">Got to Get You into My Life,Revolver,147</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="st">Help!,Help!,138</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="st">"Here, There and Everywhere",Revolver,145</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="st">I Need You,Help!,148</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="st">I Want to Tell You,Revolver,149</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="st">I'm Looking Through You,Rubber Soul,147</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="st">In My Life,Rubber Soul,148</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="st">Love You To,Revolver,181</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="st">Michelle,Rubber Soul,160</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="st">Norwegian Wood (This Bird Has Flown),Rubber Soul,125</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="st">Run for Your Life,Rubber Soul,138</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="st">She Said She Said,Revolver,157</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="st">Taxman,Revolver,159</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="st">The Night Before,Help!,153</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="st">The Word,Rubber Soul,161</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="st">Think for Yourself,Rubber Soul,138</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="st">Ticket to Ride,Help!,190</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="st">Tomorrow Never Knows,Revolver,178</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="st">Wait,Rubber Soul,136</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="st">Yellow Submarine,Revolver,158</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="st">You Won't See Me,Rubber Soul,202</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="st">You're Going to Lose That Girl,Help!,140</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="st">You've Got to Hide Your Love Away,Help!,131</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="st">'''</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> pd.read_csv(io.StringIO(csv))</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> songs[[<span class="st">'Title'</span>, <span class="st">'Album.debut'</span>, <span class="st">'Duration'</span>]].sort_values(<span class="st">'Album.debut'</span>)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>songs.groupby(<span class="st">'Album.debut'</span>)[<span class="st">'Duration'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><a name="#additional-examples-using-groupby" href=""></a> ### Additional Examples using groupby</p>
<p>groupby functions allow you to organize and analyze data that share certain features. For instance, we could find the number of songs per album:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard.groupby(<span class="st">"Album.debut"</span>)[<span class="st">"Title"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         17
Anthology 1                                                        21
Anthology 2                                                         4
Anthology 3                                                         9
Help!                                                               7
Let It Be                                                          12
Let It Be... Naked - Fly on the Wall bonus disc                     4
Live at the BBC                                                    31
Live! at the Star-Club in Hamburg, Germany; 1962                    1
Magical Mystery Tour                                               11
On Air - Live at the BBC Volume 2                                   2
Revolver                                                           11
Rock 'n' Roll Music                                                 1
Rubber Soul                                                        10
Sgt. Pepper's Lonely Hearts Club Band                              13
The Beatles                                                        30
The Beatles Bootleg Recordings 1963                                 2
The Beatles' Christmas Album                                        1
UK: 1967-1970 US: Hey Jude                                          6
UK: A Collection of Beatles Oldies US: 1962-1966                    1
UK: A Collection of Beatles Oldies US: Beatles '65                  1
UK: A Collection of Beatles Oldies US: Beatles VI                   1
UK: A Collection of Beatles Oldies US: Hey Jude                     1
UK: A Collection of Beatles Oldies US: Meet The Beatles!            1
UK: A Collection of Beatles Oldies US: The Beatles Second Album     1
UK: A Collection of Beatles Oldies US: Yesterday and Today          2
UK: A Hard Day's Night US: 1962-1966                                1
UK: A Hard Day's Night US: Beatles '65                              1
UK: A Hard Day's Night US: Hey Jude                                 2
UK: A Hard Day's Night US: Something New                            8
UK: A Hard Day's Night US: The Beatles Second Album                 1
UK: Beatles for Sale US: Beatles '65                                8
UK: Beatles for Sale US: Beatles VI                                 6
UK: Help! US: Beatles VI                                            3
UK: Help! US: Rubber Soul                                           2
UK: Help! US: Yesterday and Today                                   2
UK: Past Masters Volume 1 US: The Beatles Second Album              2
UK: Please Please Me US: Meet The Beatles!                          1
UK: Please Please Me US: Rarities                                   2
UK: Please Please Me US: The Early Beatles                         11
UK: Rarities US: Beatles '65                                        1
UK: Rarities US: Beatles VI                                         1
UK: Rarities US: Hey Jude                                           1
UK: Rarities US: Meet The Beatles!                                  1
UK: Rarities US: Rarities                                           3
UK: Rarities US: Something New                                      1
UK: Rarities US: The Beatles Second Album                           1
UK: Revolver US: Yesterday and Today                                3
UK: Rock 'n' Roll Music US: Something New                           2
UK: Rock 'n' Roll Music US: The Beatles Second Album                1
UK: Rubber Soul US: Yesterday and Today                             4
UK: With the Beatles US: Meet The Beatles!                          9
UK: With the Beatles US: The Beatles Second Album                   5
Yellow Submarine                                                    4
Name: Title, dtype: int64</code></pre>
</details>
<p>Or focus on the relative activity of Lennon and McCartney across the years, first by filtering to work that is theirs exclusively:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>beatles_jl_pm <span class="op">=</span> beatles_billboard[beatles_billboard[<span class="st">'Songwriter'</span>].isin([<span class="st">"Lennon"</span>, <span class="st">"McCartney"</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note this excludes tracks they did not write independently. <code>.isin()</code> searches for exact matches, so for example, ‘Lennon and Harrison’ would not be included.</p>
<p>Then find the ‘groups’:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> beatles_jl_pm.groupby(<span class="st">"Songwriter"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(grouped.groups.keys())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>['Lennon', 'McCartney']</code></pre>
<p>And inspect a single “group”:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>grouped.get_group(<span class="st">"Lennon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<div>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
Title
</th>
<th>
Year
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Songwriter
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
2
</th>
<td>
A Hard Day’s Night
</td>
<td>
1964
</td>
<td>
UK: A Hard Day’s Night US: 1962-1966
</td>
<td>
152
</td>
<td>
35
</td>
<td>
Rock, Electronic, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon, with McCartney
</td>
<td>
8
</td>
</tr>
<tr>
<th>
5
</th>
<td>
Across the Universe
</td>
<td>
1968
</td>
<td>
Let It Be
</td>
<td>
230
</td>
<td>
19
</td>
<td>
Psychedelic folk, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
8
</th>
<td>
All I’ve Got to Do
</td>
<td>
1963
</td>
<td>
UK: With the Beatles US: Meet The Beatles!
</td>
<td>
124
</td>
<td>
9
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
12
</th>
<td>
All You Need Is Love
</td>
<td>
1967
</td>
<td>
Magical Mystery Tour
</td>
<td>
237
</td>
<td>
25
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
15
</td>
</tr>
<tr>
<th>
24
</th>
<td>
Bad to Me
</td>
<td>
1963
</td>
<td>
The Beatles Bootleg Recordings 1963
</td>
<td>
142
</td>
<td>
0
</td>
<td>
Beat, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
295
</th>
<td>
Yer Blues
</td>
<td>
1968
</td>
<td>
The Beatles
</td>
<td>
241
</td>
<td>
11
</td>
<td>
Blues Rock, Hard Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
296
</th>
<td>
Yes It Is
</td>
<td>
1965
</td>
<td>
UK: Rarities US: Beatles VI
</td>
<td>
161
</td>
<td>
16
</td>
<td>
Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon, McCartney and Harrison
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
298
</th>
<td>
You Can’t Do That
</td>
<td>
1964
</td>
<td>
UK: A Hard Day’s Night US: The Beatles Second …
</td>
<td>
157
</td>
<td>
25
</td>
<td>
Rock and Roll, R&amp;B, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
305
</th>
<td>
You’re Going to Lose That Girl
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
140
</td>
<td>
6
</td>
<td>
Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
<tr>
<th>
306
</th>
<td>
You’ve Got to Hide Your Love Away
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
131
</td>
<td>
12
</td>
<td>
FolkPop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
</tr>
</tbody>
</table>
<p>
65 rows × 9 columns
</p>
</div>
</details>
<p>And finally to compare the outputs by grouping via two columns, songwriter and year.</p>
<p>“Size” considers <em>all</em> the rows (even ones with NaNs).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>beatles_jl_pm.groupby([<span class="st">'Songwriter'</span>,<span class="st">'Year'</span>]).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Songwriter  Year
Lennon      1960     1
            1962     2
            1963     6
            1964    12
            1965     7
            1966     5
            1967     3
            1968    17
            1969    12
McCartney   1960     1
            1962     4
            1963     2
            1964     7
            1965     8
            1966     9
            1967     7
            1968    14
            1969    15
dtype: int64</code></pre>
</details>
<p>“Count” includes only the rows with valid data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>beatles_jl_pm.groupby([<span class="st">'Songwriter'</span>,<span class="st">'Year'</span>]).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<div>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
</th>
<th>
Title
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
</tr>
<tr>
<th>
Songwriter
</th>
<th>
Year
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="9" valign="top">
Lennon
</th>
<th>
1960
</th>
<td>
1
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
<tr>
<th>
1962
</th>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
</tr>
<tr>
<th>
1963
</th>
<td>
6
</td>
<td>
6
</td>
<td>
6
</td>
<td>
6
</td>
<td>
6
</td>
<td>
6
</td>
<td>
6
</td>
</tr>
<tr>
<th>
1964
</th>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
</tr>
<tr>
<th>
1965
</th>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
</tr>
<tr>
<th>
1966
</th>
<td>
5
</td>
<td>
5
</td>
<td>
5
</td>
<td>
5
</td>
<td>
5
</td>
<td>
5
</td>
<td>
5
</td>
</tr>
<tr>
<th>
1967
</th>
<td>
3
</td>
<td>
3
</td>
<td>
3
</td>
<td>
3
</td>
<td>
3
</td>
<td>
3
</td>
<td>
3
</td>
</tr>
<tr>
<th>
1968
</th>
<td>
17
</td>
<td>
17
</td>
<td>
17
</td>
<td>
17
</td>
<td>
17
</td>
<td>
17
</td>
<td>
17
</td>
</tr>
<tr>
<th>
1969
</th>
<td>
12
</td>
<td>
10
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
<td>
12
</td>
</tr>
<tr>
<th rowspan="9" valign="top">
McCartney
</th>
<th>
1960
</th>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
1
</td>
</tr>
<tr>
<th>
1962
</th>
<td>
4
</td>
<td>
1
</td>
<td>
4
</td>
<td>
4
</td>
<td>
4
</td>
<td>
3
</td>
<td>
4
</td>
</tr>
<tr>
<th>
1963
</th>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
<td>
2
</td>
</tr>
<tr>
<th>
1964
</th>
<td>
7
</td>
<td>
6
</td>
<td>
7
</td>
<td>
7
</td>
<td>
6
</td>
<td>
7
</td>
<td>
7
</td>
</tr>
<tr>
<th>
1965
</th>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
<td>
8
</td>
</tr>
<tr>
<th>
1966
</th>
<td>
9
</td>
<td>
9
</td>
<td>
9
</td>
<td>
9
</td>
<td>
9
</td>
<td>
9
</td>
<td>
9
</td>
</tr>
<tr>
<th>
1967
</th>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
<td>
7
</td>
</tr>
<tr>
<th>
1968
</th>
<td>
14
</td>
<td>
12
</td>
<td>
14
</td>
<td>
14
</td>
<td>
14
</td>
<td>
14
</td>
<td>
14
</td>
</tr>
<tr>
<th>
1969
</th>
<td>
15
</td>
<td>
14
</td>
<td>
15
</td>
<td>
15
</td>
<td>
15
</td>
<td>
15
</td>
<td>
15
</td>
</tr>
</tbody>
</table>
</div>
</details>
<p>There are many other functions that can be applied to aggregate, filter and transform data within groups! See the supplemental essay on groupby functions for more in-depth information.</p>
<p>You may also notice that there is a lot of redundancy in this table. To only list the results of one column, you can specify just like any other pandas operation using [column-name] before .count(). See the next example.</p>
<p>A count of track titles per album:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>beatles_billboard.groupby(<span class="st">"Album.debut"</span>)[<span class="st">"Title"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         17
Anthology 1                                                        21
Anthology 2                                                         4
Anthology 3                                                         9
Help!                                                               7
Let It Be                                                          12
Let It Be... Naked - Fly on the Wall bonus disc                     4
Live at the BBC                                                    31
Live! at the Star-Club in Hamburg, Germany; 1962                    1
Magical Mystery Tour                                               11
On Air - Live at the BBC Volume 2                                   2
Revolver                                                           11
Rock 'n' Roll Music                                                 1
Rubber Soul                                                        10
Sgt. Pepper's Lonely Hearts Club Band                              13
The Beatles                                                        30
The Beatles Bootleg Recordings 1963                                 2
The Beatles' Christmas Album                                        1
UK: 1967-1970 US: Hey Jude                                          6
UK: A Collection of Beatles Oldies US: 1962-1966                    1
UK: A Collection of Beatles Oldies US: Beatles '65                  1
UK: A Collection of Beatles Oldies US: Beatles VI                   1
UK: A Collection of Beatles Oldies US: Hey Jude                     1
UK: A Collection of Beatles Oldies US: Meet The Beatles!            1
UK: A Collection of Beatles Oldies US: The Beatles Second Album     1
UK: A Collection of Beatles Oldies US: Yesterday and Today          2
UK: A Hard Day's Night US: 1962-1966                                1
UK: A Hard Day's Night US: Beatles '65                              1
UK: A Hard Day's Night US: Hey Jude                                 2
UK: A Hard Day's Night US: Something New                            8
UK: A Hard Day's Night US: The Beatles Second Album                 1
UK: Beatles for Sale US: Beatles '65                                8
UK: Beatles for Sale US: Beatles VI                                 6
UK: Help! US: Beatles VI                                            3
UK: Help! US: Rubber Soul                                           2
UK: Help! US: Yesterday and Today                                   2
UK: Past Masters Volume 1 US: The Beatles Second Album              2
UK: Please Please Me US: Meet The Beatles!                          1
UK: Please Please Me US: Rarities                                   2
UK: Please Please Me US: The Early Beatles                         11
UK: Rarities US: Beatles '65                                        1
UK: Rarities US: Beatles VI                                         1
UK: Rarities US: Hey Jude                                           1
UK: Rarities US: Meet The Beatles!                                  1
UK: Rarities US: Rarities                                           3
UK: Rarities US: Something New                                      1
UK: Rarities US: The Beatles Second Album                           1
UK: Revolver US: Yesterday and Today                                3
UK: Rock 'n' Roll Music US: Something New                           2
UK: Rock 'n' Roll Music US: The Beatles Second Album                1
UK: Rubber Soul US: Yesterday and Today                             4
UK: With the Beatles US: Meet The Beatles!                          9
UK: With the Beatles US: The Beatles Second Album                   5
Yellow Submarine                                                    4
Name: Title, dtype: int64</code></pre>
</details>
<p><a name="#using-our-aggregate-functions-to-work-with-all-groups" href=""></a> ### Using our Aggregate Functions to Work With All Groups</p>
<p>When you work with all groups simultaneously, there are a number of possible operations you can perform.</p>
<section id="see-the-size-number-of-rows-of-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-size-number-of-rows-of-each-group">See the size (number of rows) of each group</h5>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>grouped.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         17
Anthology 1                                                        21
Anthology 2                                                         4
Anthology 3                                                         9
Help!                                                               7
Let It Be                                                          12
Let It Be... Naked - Fly on the Wall bonus disc                     4
Live at the BBC                                                    31
Live! at the Star-Club in Hamburg, Germany; 1962                    1
Magical Mystery Tour                                               11
On Air - Live at the BBC Volume 2                                   2
Revolver                                                           11
Rock 'n' Roll Music                                                 1
Rubber Soul                                                        10
Sgt. Pepper's Lonely Hearts Club Band                              13
The Beatles                                                        30
The Beatles Bootleg Recordings 1963                                 2
The Beatles' Christmas Album                                        1
UK: 1967-1970 US: Hey Jude                                          6
UK: A Collection of Beatles Oldies US: 1962-1966                    1
UK: A Collection of Beatles Oldies US: Beatles '65                  1
UK: A Collection of Beatles Oldies US: Beatles VI                   1
UK: A Collection of Beatles Oldies US: Hey Jude                     1
UK: A Collection of Beatles Oldies US: Meet The Beatles!            1
UK: A Collection of Beatles Oldies US: The Beatles Second Album     1
UK: A Collection of Beatles Oldies US: Yesterday and Today          2
UK: A Hard Day's Night US: 1962-1966                                1
UK: A Hard Day's Night US: Beatles '65                              1
UK: A Hard Day's Night US: Hey Jude                                 2
UK: A Hard Day's Night US: Something New                            8
UK: A Hard Day's Night US: The Beatles Second Album                 1
UK: Beatles for Sale US: Beatles '65                                8
UK: Beatles for Sale US: Beatles VI                                 6
UK: Help! US: Beatles VI                                            3
UK: Help! US: Rubber Soul                                           2
UK: Help! US: Yesterday and Today                                   2
UK: Past Masters Volume 1 US: The Beatles Second Album              2
UK: Please Please Me US: Meet The Beatles!                          1
UK: Please Please Me US: Rarities                                   2
UK: Please Please Me US: The Early Beatles                         11
UK: Rarities US: Beatles '65                                        1
UK: Rarities US: Beatles VI                                         1
UK: Rarities US: Hey Jude                                           1
UK: Rarities US: Meet The Beatles!                                  1
UK: Rarities US: Rarities                                           3
UK: Rarities US: Something New                                      1
UK: Rarities US: The Beatles Second Album                           1
UK: Revolver US: Yesterday and Today                                3
UK: Rock 'n' Roll Music US: Something New                           2
UK: Rock 'n' Roll Music US: The Beatles Second Album                1
UK: Rubber Soul US: Yesterday and Today                             4
UK: With the Beatles US: Meet The Beatles!                          9
UK: With the Beatles US: The Beatles Second Album                   5
Yellow Submarine                                                    4
dtype: int64</code></pre>
</details>
</section>
<section id="see-the-number-of-unique-rows-in-each-column-of-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-number-of-unique-rows-in-each-column-of-each-group">See the number of unique rows in each <em>column</em> of each group</h5>
<div class="sourceCode" id="cb48"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>grouped.nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th>Title</th>
<th>Year</th>
<th>Duration</th>
<th>Other.releases</th>
<th>Genre</th>
<th>Songwriter</th>
<th>Lead.vocal</th>
<th>Top.50.Billboard</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Album.debut</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">Abbey Road</td>
<td>17</td>
<td>1</td>
<td>17</td>
<td>9</td>
<td>12</td>
<td>4</td>
<td>6</td>
<td>3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 1</td>
<td>21</td>
<td>7</td>
<td>14</td>
<td>3</td>
<td>14</td>
<td>19</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td style="text-align: center;">Anthology 2</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 3</td>
<td>9</td>
<td>2</td>
<td>8</td>
<td>1</td>
<td>7</td>
<td>6</td>
<td>4</td>
<td>1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Help!</td>
<td>7</td>
<td>1</td>
<td>7</td>
<td>7</td>
<td>7</td>
<td>4</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: Rock ‘n’ Roll Music US: The Beatles Second Album</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: Rubber Soul US: Yesterday and Today</td>
<td>4</td>
<td>1</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>2</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: With the Beatles US: Meet The Beatles!</td>
<td>9</td>
<td>1</td>
<td>8</td>
<td>8</td>
<td>5</td>
<td>7</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: With the Beatles US: The Beatles Second Album</td>
<td>5</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Yellow Submarine</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>54 rows × 8 columns</p>
</details>
<p>Now that you have a better sense of what the data looks like, you can begin to perform operations on it. These operations should be performed on a specific column, or just a few columns. For example, while it makes sense to compute the mean of the ‘Duration’ column, it doesn’t make sense to compute the mean of the ‘Title’ column (and in fact you can’t)!</p>
<p>You can select columns to operate on the same way you would with a regular dataframe, using square brackets: grouped[‘column_name’] or grouped[[‘column_1’, ‘column_2’]].</p>
<p>You can perform any of the common counting operations—.size(), .count(), or .nunique()—individually, depending on your needs. Here is an example of each, applied to a different column or columns:</p>
</section>
<section id="see-the-size-number-of-rows-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-size-number-of-rows-in-the-specified-columns-for-each-group">See the size (number of rows), <em>in the specified column(s)</em>, for each group</h5>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Duration'</span>].size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         17
Anthology 1                                                        21
Anthology 2                                                         4
Anthology 3                                                         9
Help!                                                               7
Let It Be                                                          12
Let It Be... Naked - Fly on the Wall bonus disc                     4
Live at the BBC                                                    31
Live! at the Star-Club in Hamburg, Germany; 1962                    1
Magical Mystery Tour                                               11
On Air - Live at the BBC Volume 2                                   2
Revolver                                                           11
Rock 'n' Roll Music                                                 1
Rubber Soul                                                        10
Sgt. Pepper's Lonely Hearts Club Band                              13
The Beatles                                                        30
The Beatles Bootleg Recordings 1963                                 2
The Beatles' Christmas Album                                        1
UK: 1967-1970 US: Hey Jude                                          6
UK: A Collection of Beatles Oldies US: 1962-1966                    1
UK: A Collection of Beatles Oldies US: Beatles '65                  1
UK: A Collection of Beatles Oldies US: Beatles VI                   1
UK: A Collection of Beatles Oldies US: Hey Jude                     1
UK: A Collection of Beatles Oldies US: Meet The Beatles!            1
UK: A Collection of Beatles Oldies US: The Beatles Second Album     1
UK: A Collection of Beatles Oldies US: Yesterday and Today          2
UK: A Hard Day's Night US: 1962-1966                                1
UK: A Hard Day's Night US: Beatles '65                              1
UK: A Hard Day's Night US: Hey Jude                                 2
UK: A Hard Day's Night US: Something New                            8
UK: A Hard Day's Night US: The Beatles Second Album                 1
UK: Beatles for Sale US: Beatles '65                                8
UK: Beatles for Sale US: Beatles VI                                 6
UK: Help! US: Beatles VI                                            3
UK: Help! US: Rubber Soul                                           2
UK: Help! US: Yesterday and Today                                   2
UK: Past Masters Volume 1 US: The Beatles Second Album              2
UK: Please Please Me US: Meet The Beatles!                          1
UK: Please Please Me US: Rarities                                   2
UK: Please Please Me US: The Early Beatles                         11
UK: Rarities US: Beatles '65                                        1
UK: Rarities US: Beatles VI                                         1
UK: Rarities US: Hey Jude                                           1
UK: Rarities US: Meet The Beatles!                                  1
UK: Rarities US: Rarities                                           3
UK: Rarities US: Something New                                      1
UK: Rarities US: The Beatles Second Album                           1
UK: Revolver US: Yesterday and Today                                3
UK: Rock 'n' Roll Music US: Something New                           2
UK: Rock 'n' Roll Music US: The Beatles Second Album                1
UK: Rubber Soul US: Yesterday and Today                             4
UK: With the Beatles US: Meet The Beatles!                          9
UK: With the Beatles US: The Beatles Second Album                   5
Yellow Submarine                                                    4
Name: Duration, dtype: int64</code></pre>
</details>
</section>
<section id="see-the-number-of-rows-without-missing-data-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-number-of-rows-without-missing-data-in-the-specified-columns-for-each-group">See the number of rows without missing data, <em>in the specified column(s)</em>, for each group</h5>
<div class="sourceCode" id="cb51"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>grouped[[<span class="st">'Title'</span>, <span class="st">'Lead.vocal'</span>]].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th>Title</th>
<th>Lead.vocal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Album.debut</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">Abbey Road</td>
<td>17</td>
<td>17</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 1</td>
<td>21</td>
<td>19</td>
</tr>
<tr class="even">
<td style="text-align: center;">Anthology 2</td>
<td>4</td>
<td>3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 3</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="even">
<td style="text-align: center;">Help!</td>
<td>7</td>
<td>7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: Rock ‘n’ Roll Music US: The Beatles Second Album</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: Rubber Soul US: Yesterday and Today</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: With the Beatles US: Meet The Beatles!</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: With the Beatles US: The Beatles Second Album</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td style="text-align: center;">Yellow Submarine</td>
<td>4</td>
<td>4</td>
</tr>
</tbody>
</table>
</details>
</section>
<section id="see-the-number-of-unique-rows-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-number-of-unique-rows-in-the-specified-columns-for-each-group">See the number of unique rows, in the specified column(s), for each group</h5>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Other.releases'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                          9
Anthology 1                                                         3
Anthology 2                                                         2
Anthology 3                                                         1
Help!                                                               7
Let It Be                                                           9
Let It Be... Naked - Fly on the Wall bonus disc                     1
Live at the BBC                                                     2
Live! at the Star-Club in Hamburg, Germany; 1962                    1
Magical Mystery Tour                                                8
On Air - Live at the BBC Volume 2                                   1
Revolver                                                            9
Rock 'n' Roll Music                                                 1
Rubber Soul                                                        10
Sgt. Pepper's Lonely Hearts Club Band                               5
The Beatles                                                        10
The Beatles Bootleg Recordings 1963                                 1
The Beatles' Christmas Album                                        1
UK: 1967-1970 US: Hey Jude                                          6
UK: A Collection of Beatles Oldies US: 1962-1966                    1
UK: A Collection of Beatles Oldies US: Beatles '65                  1
UK: A Collection of Beatles Oldies US: Beatles VI                   1
UK: A Collection of Beatles Oldies US: Hey Jude                     1
UK: A Collection of Beatles Oldies US: Meet The Beatles!            1
UK: A Collection of Beatles Oldies US: The Beatles Second Album     1
UK: A Collection of Beatles Oldies US: Yesterday and Today          2
UK: A Hard Day's Night US: 1962-1966                                1
UK: A Hard Day's Night US: Beatles '65                              1
UK: A Hard Day's Night US: Hey Jude                                 2
UK: A Hard Day's Night US: Something New                            6
UK: A Hard Day's Night US: The Beatles Second Album                 1
UK: Beatles for Sale US: Beatles '65                                6
UK: Beatles for Sale US: Beatles VI                                 5
UK: Help! US: Beatles VI                                            3
UK: Help! US: Rubber Soul                                           2
UK: Help! US: Yesterday and Today                                   2
UK: Past Masters Volume 1 US: The Beatles Second Album              2
UK: Please Please Me US: Meet The Beatles!                          1
UK: Please Please Me US: Rarities                                   2
UK: Please Please Me US: The Early Beatles                         11
UK: Rarities US: Beatles '65                                        1
UK: Rarities US: Beatles VI                                         1
UK: Rarities US: Hey Jude                                           1
UK: Rarities US: Meet The Beatles!                                  1
UK: Rarities US: Rarities                                           3
UK: Rarities US: Something New                                      1
UK: Rarities US: The Beatles Second Album                           1
UK: Revolver US: Yesterday and Today                                3
UK: Rock 'n' Roll Music US: Something New                           2
UK: Rock 'n' Roll Music US: The Beatles Second Album                1
UK: Rubber Soul US: Yesterday and Today                             4
UK: With the Beatles US: Meet The Beatles!                          8
UK: With the Beatles US: The Beatles Second Album                   5
Yellow Submarine                                                    4
Name: Other.releases, dtype: int64</code></pre>
</details>
</section>
<section id="see-the-sum-of-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-sum-of-the-specified-columns-for-each-group">See the sum of the specified column(s) for each group</h5>
<p>This will work with textual data, but it doesn’t make sense! All the text entries in a column will be combined into one string. sum is best used with numerical data.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Duration'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         2829
Anthology 1                                                        3100
Anthology 2                                                         725
Anthology 3                                                        1631
Help!                                                              1024
Let It Be                                                          2109
Let It Be... Naked - Fly on the Wall bonus disc                     704
Live at the BBC                                                    4264
Live! at the Star-Club in Hamburg, Germany; 1962                    150
Magical Mystery Tour                                               2200
On Air - Live at the BBC Volume 2                                   218
Revolver                                                           1652
Rock 'n' Roll Music                                                 153
Rubber Soul                                                        1508
Sgt. Pepper's Lonely Hearts Club Band                              2376
The Beatles                                                        5558
The Beatles Bootleg Recordings 1963                                 234
The Beatles' Christmas Album                                        183
UK: 1967-1970 US: Hey Jude                                         1358
UK: A Collection of Beatles Oldies US: 1962-1966                    116
UK: A Collection of Beatles Oldies US: Beatles '65                  145
UK: A Collection of Beatles Oldies US: Beatles VI                   150
UK: A Collection of Beatles Oldies US: Hey Jude                     138
UK: A Collection of Beatles Oldies US: Meet The Beatles!            144
UK: A Collection of Beatles Oldies US: The Beatles Second Album     138
UK: A Collection of Beatles Oldies US: Yesterday and Today          305
UK: A Hard Day's Night US: 1962-1966                                152
UK: A Hard Day's Night US: Beatles '65                              140
UK: A Hard Day's Night US: Hey Jude                                 295
UK: A Hard Day's Night US: Something New                           1100
UK: A Hard Day's Night US: The Beatles Second Album                 157
UK: Beatles for Sale US: Beatles '65                               1135
UK: Beatles for Sale US: Beatles VI                                 873
UK: Help! US: Beatles VI                                            456
UK: Help! US: Rubber Soul                                           242
UK: Help! US: Yesterday and Today                                   262
UK: Past Masters Volume 1 US: The Beatles Second Album              253
UK: Please Please Me US: Meet The Beatles!                          175
UK: Please Please Me US: Rarities                                   216
UK: Please Please Me US: The Early Beatles                         1553
UK: Rarities US: Beatles '65                                        183
UK: Rarities US: Beatles VI                                         161
UK: Rarities US: Hey Jude                                           179
UK: Rarities US: Meet The Beatles!                                  133
UK: Rarities US: Rarities                                           556
UK: Rarities US: Something New                                      146
UK: Rarities US: The Beatles Second Album                           121
UK: Revolver US: Yesterday and Today                                438
UK: Rock 'n' Roll Music US: Something New                           292
UK: Rock 'n' Roll Music US: The Beatles Second Album                130
UK: Rubber Soul US: Yesterday and Today                             625
UK: With the Beatles US: Meet The Beatles!                         1157
UK: With the Beatles US: The Beatles Second Album                   820
Yellow Submarine                                                    919
Name: Duration, dtype: int64</code></pre>
</details>
</section>
<section id="see-the-maximum-value-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-maximum-value-in-the-specified-columns-for-each-group">See the maximum value in the specified column(s) for each group</h5>
<p>Only works with numerical data</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Top.50.Billboard'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         30
Anthology 1                                                        45
Anthology 2                                                        47
Anthology 3                                                        -1
Help!                                                              17
Let It Be                                                          20
Let It Be... Naked - Fly on the Wall bonus disc                    -1
Live at the BBC                                                    -1
Live! at the Star-Club in Hamburg, Germany; 1962                   -1
Magical Mystery Tour                                               48
On Air - Live at the BBC Volume 2                                  -1
Revolver                                                           38
Rock 'n' Roll Music                                                -1
Rubber Soul                                                        -1
Sgt. Pepper's Lonely Hearts Club Band                              -1
The Beatles                                                        -1
The Beatles Bootleg Recordings 1963                                -1
The Beatles' Christmas Album                                       -1
UK: 1967-1970 US: Hey Jude                                         32
UK: A Collection of Beatles Oldies US: 1962-1966                   -1
UK: A Collection of Beatles Oldies US: Beatles '65                 11
UK: A Collection of Beatles Oldies US: Beatles VI                  -1
UK: A Collection of Beatles Oldies US: Hey Jude                    19
UK: A Collection of Beatles Oldies US: Meet The Beatles!            2
UK: A Collection of Beatles Oldies US: The Beatles Second Album     3
UK: A Collection of Beatles Oldies US: Yesterday and Today         29
UK: A Hard Day's Night US: 1962-1966                                8
UK: A Hard Day's Night US: Beatles '65                             -1
UK: A Hard Day's Night US: Hey Jude                                10
UK: A Hard Day's Night US: Something New                           43
UK: A Hard Day's Night US: The Beatles Second Album                -1
UK: Beatles for Sale US: Beatles '65                               -1
UK: Beatles for Sale US: Beatles VI                                49
UK: Help! US: Beatles VI                                           -1
UK: Help! US: Rubber Soul                                          -1
UK: Help! US: Yesterday and Today                                  50
UK: Past Masters Volume 1 US: The Beatles Second Album             -1
UK: Please Please Me US: Meet The Beatles!                         36
UK: Please Please Me US: Rarities                                  -1
UK: Please Please Me US: The Early Beatles                         34
UK: Rarities US: Beatles '65                                       31
UK: Rarities US: Beatles VI                                        -1
UK: Rarities US: Hey Jude                                          42
UK: Rarities US: Meet The Beatles!                                 -1
UK: Rarities US: Rarities                                          -1
UK: Rarities US: Something New                                     -1
UK: Rarities US: The Beatles Second Album                          46
UK: Revolver US: Yesterday and Today                               -1
UK: Rock 'n' Roll Music US: Something New                          44
UK: Rock 'n' Roll Music US: The Beatles Second Album               -1
UK: Rubber Soul US: Yesterday and Today                            27
UK: With the Beatles US: Meet The Beatles!                         -1
UK: With the Beatles US: The Beatles Second Album                  -1
Yellow Submarine                                                   -1
Name: Top.50.Billboard, dtype: int64</code></pre>
</details>
</section>
<section id="see-the-minimum-value-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-minimum-value-in-the-specified-columns-for-each-group">See the minimum value in the specified column(s) for each group</h5>
<p>Only works with numerical data</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>grouped[[<span class="st">'Other.releases'</span>, <span class="st">'Top.50.Billboard'</span>]].<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<p>Output</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th>Other.releases</th>
<th>Top.50.Billboard</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Album.debut</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">Abbey Road</td>
<td>5</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 1</td>
<td>0</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Anthology 2</td>
<td>0</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Anthology 3</td>
<td>0</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Help!</td>
<td>6</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: Rock ‘n’ Roll Music US: The Beatles Second Album</td>
<td>35</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: Rubber Soul US: Yesterday and Today</td>
<td>9</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">UK: With the Beatles US: Meet The Beatles!</td>
<td>9</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">UK: With the Beatles US: The Beatles Second Album</td>
<td>2</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Yellow Submarine</td>
<td>8</td>
<td>-1</td>
</tr>
</tbody>
</table>
<p>54 rows × 2 columns</p>
</details>
</section>
<section id="see-the-average-value-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-average-value-in-the-specified-columns-for-each-group">See the average value in the specified column(s) for each group</h5>
<p>Only works with numerical data</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Top.50.Billboard'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                          1.235294
Anthology 1                                                         5.095238
Anthology 2                                                        11.000000
Anthology 3                                                        -1.000000
Help!                                                               3.714286
Let It Be                                                           1.666667
Let It Be... Naked - Fly on the Wall bonus disc                    -1.000000
Live at the BBC                                                    -1.000000
Live! at the Star-Club in Hamburg, Germany; 1962                   -1.000000
Magical Mystery Tour                                               11.000000
On Air - Live at the BBC Volume 2                                  -1.000000
Revolver                                                            7.090909
Rock 'n' Roll Music                                                -1.000000
Rubber Soul                                                        -1.000000
Sgt. Pepper's Lonely Hearts Club Band                              -1.000000
The Beatles                                                        -1.000000
The Beatles Bootleg Recordings 1963                                -1.000000
The Beatles' Christmas Album                                       -1.000000
UK: 1967-1970 US: Hey Jude                                         13.500000
UK: A Collection of Beatles Oldies US: 1962-1966                   -1.000000
UK: A Collection of Beatles Oldies US: Beatles '65                 11.000000
UK: A Collection of Beatles Oldies US: Beatles VI                  -1.000000
UK: A Collection of Beatles Oldies US: Hey Jude                    19.000000
UK: A Collection of Beatles Oldies US: Meet The Beatles!            2.000000
UK: A Collection of Beatles Oldies US: The Beatles Second Album     3.000000
UK: A Collection of Beatles Oldies US: Yesterday and Today         19.000000
UK: A Hard Day's Night US: 1962-1966                                8.000000
UK: A Hard Day's Night US: Beatles '65                             -1.000000
UK: A Hard Day's Night US: Hey Jude                                 4.500000
UK: A Hard Day's Night US: Something New                            9.250000
UK: A Hard Day's Night US: The Beatles Second Album                -1.000000
UK: Beatles for Sale US: Beatles '65                               -1.000000
UK: Beatles for Sale US: Beatles VI                                11.000000
UK: Help! US: Beatles VI                                           -1.000000
UK: Help! US: Rubber Soul                                          -1.000000
UK: Help! US: Yesterday and Today                                  31.000000
UK: Past Masters Volume 1 US: The Beatles Second Album             -1.000000
UK: Please Please Me US: Meet The Beatles!                         36.000000
UK: Please Please Me US: Rarities                                  -1.000000
UK: Please Please Me US: The Early Beatles                          9.181818
UK: Rarities US: Beatles '65                                       31.000000
UK: Rarities US: Beatles VI                                        -1.000000
UK: Rarities US: Hey Jude                                          42.000000
UK: Rarities US: Meet The Beatles!                                 -1.000000
UK: Rarities US: Rarities                                          -1.000000
UK: Rarities US: Something New                                     -1.000000
UK: Rarities US: The Beatles Second Album                          46.000000
UK: Revolver US: Yesterday and Today                               -1.000000
UK: Rock 'n' Roll Music US: Something New                          42.000000
UK: Rock 'n' Roll Music US: The Beatles Second Album               -1.000000
UK: Rubber Soul US: Yesterday and Today                             6.000000
UK: With the Beatles US: Meet The Beatles!                         -1.000000
UK: With the Beatles US: The Beatles Second Album                  -1.000000
Yellow Submarine                                                   -1.000000
Name: Top.50.Billboard, dtype: float64</code></pre>
</details>
<p>With the Top 50 Billboard, we took the max, min, and average. In the min, we discovered that -1 is a placeholder value for when a title does not make the top 50. So, our averages don’t actually mean much, and we would want to filter the data to greater than 0 before doing these operations. This is why it is important to look into your data before doing one operation and drawing conclusions.</p>
</section>
<section id="see-the-standard-deviation-in-the-specified-columns-for-each-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-standard-deviation-in-the-specified-columns-for-each-group">See the standard deviation in the specified column(s) for each group</h5>
<p>Only works with numerical data</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">'Duration'</span>].std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Album.debut
Abbey Road                                                         100.616884
Anthology 1                                                         33.071855
Anthology 2                                                         38.482680
Anthology 3                                                         81.551790
Help!                                                               21.592547
Let It Be                                                           68.439921
Let It Be... Naked - Fly on the Wall bonus disc                     52.000000
Live at the BBC                                                     22.409579
Live! at the Star-Club in Hamburg, Germany; 1962                          NaN
Magical Mystery Tour                                                42.878899
On Air - Live at the BBC Volume 2                                    4.242641
Revolver                                                            19.338139
Rock 'n' Roll Music                                                       NaN
Rubber Soul                                                         21.212156
Sgt. Pepper's Lonely Hearts Club Band                               69.883419
The Beatles                                                         77.810084
The Beatles Bootleg Recordings 1963                                 35.355339
The Beatles' Christmas Album                                              NaN
UK: 1967-1970 US: Hey Jude                                         103.903160
UK: A Collection of Beatles Oldies US: 1962-1966                          NaN
UK: A Collection of Beatles Oldies US: Beatles '65                        NaN
UK: A Collection of Beatles Oldies US: Beatles VI                         NaN
UK: A Collection of Beatles Oldies US: Hey Jude                           NaN
UK: A Collection of Beatles Oldies US: Meet The Beatles!                  NaN
UK: A Collection of Beatles Oldies US: The Beatles Second Album           NaN
UK: A Collection of Beatles Oldies US: Yesterday and Today          24.748737
UK: A Hard Day's Night US: 1962-1966                                      NaN
UK: A Hard Day's Night US: Beatles '65                                    NaN
UK: A Hard Day's Night US: Hey Jude                                 23.334524
UK: A Hard Day's Night US: Something New                            12.983506
UK: A Hard Day's Night US: The Beatles Second Album                       NaN
UK: Beatles for Sale US: Beatles '65                                20.773868
UK: Beatles for Sale US: Beatles VI                                 19.377822
UK: Help! US: Beatles VI                                             6.082763
UK: Help! US: Rubber Soul                                            8.485281
UK: Help! US: Yesterday and Today                                   11.313708
UK: Past Masters Volume 1 US: The Beatles Second Album               3.535534
UK: Please Please Me US: Meet The Beatles!                                NaN
UK: Please Please Me US: Rarities                                    1.414214
UK: Please Please Me US: The Early Beatles                          17.954488
UK: Rarities US: Beatles '65                                              NaN
UK: Rarities US: Beatles VI                                               NaN
UK: Rarities US: Hey Jude                                                 NaN
UK: Rarities US: Meet The Beatles!                                        NaN
UK: Rarities US: Rarities                                           66.078236
UK: Rarities US: Something New                                            NaN
UK: Rarities US: The Beatles Second Album                                 NaN
UK: Revolver US: Yesterday and Today                                31.953091
UK: Rock 'n' Roll Music US: Something New                           41.012193
UK: Rock 'n' Roll Music US: The Beatles Second Album                      NaN
UK: Rubber Soul US: Yesterday and Today                             12.816006
UK: With the Beatles US: Meet The Beatles!                          16.432522
UK: With the Beatles US: The Beatles Second Album                   13.247641
Yellow Submarine                                                   110.738054
Name: Duration, dtype: float64</code></pre>
</details>
<p>Note that some of the standard deviations are NaN! Can you guess why?</p>
<p><em>Hint: can you find how many rows are in that group?</em></p>
<p><a name="working-with-a-single-group" href=""></a> ### Working With a Single Group</p>
<p>Another way to make use of a groupby object is to examine one group in particular.</p>
</section>
<section id="see-the-list-of-groups" class="level5">
<h5 class="anchored" data-anchor-id="see-the-list-of-groups">See the list of groups</h5>
<div class="sourceCode" id="cb63"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(grouped.groups.keys())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What’s going on here?</p>
<p>grouped.groups returns a dictionary, wherein each key is a group name and each value is a list. The list contains the indices of each item from the original dataframe that is in that group.</p>
<p>If we want to see all of the group names, we only need the keys of this dictionary. However, grouped.groups.keys() comes out in a weird format. We can fix this by converting the output to a list, using list(). The result is a nicely formatted list of every group name in the groupby object.</p>
<details>
<summary>
Output
</summary>
<p>[‘Abbey Road’,<br> ‘Anthology 1’,<br> ‘Anthology 2’,<br> ‘Anthology 3’,<br> ‘Help!’,<br> …<br> “UK: Rock ‘n’ Roll Music US: The Beatles Second Album”,<br> ‘UK: Rubber Soul US: Yesterday and Today’,<br> ‘UK: With the Beatles US: Meet The Beatles!’,<br> ‘UK: With the Beatles US: The Beatles Second Album’,<br> ‘Yellow Submarine’]</p>
</details>
</section>
<section id="check-the-number-of-groups" class="level5">
<h5 class="anchored" data-anchor-id="check-the-number-of-groups">Check the number of groups</h5>
<div class="sourceCode" id="cb64"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>grouped.ngroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Output</p>
<p><code>54</code></p>
</section>
<section id="see-the-contents-of-a-group" class="level5">
<h5 class="anchored" data-anchor-id="see-the-contents-of-a-group">See the contents of a group</h5>
<div class="sourceCode" id="cb65"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span> <span class="op">=</span> grouped.get_group(<span class="st">'Help!'</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># see the group</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th>Title</th>
<th>Year</th>
<th>Album.debut</th>
<th>Duration</th>
<th>Other.releases</th>
<th>Genre</th>
<th>Songwriter</th>
<th>Lead.vocal</th>
<th>Top.50.Billboard</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">16</td>
<td>Another Girl</td>
<td>1965</td>
<td>Help!</td>
<td>124</td>
<td>9</td>
<td>Country Rock, Pop/Rock</td>
<td>McCartney</td>
<td>McCartney</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">92</td>
<td>Help!</td>
<td>1965</td>
<td>Help!</td>
<td>138</td>
<td>34</td>
<td>Folk Rock, Pop/Rock</td>
<td>Lennon, with McCartney</td>
<td>Lennon</td>
<td>14</td>
</tr>
<tr class="odd">
<td style="text-align: center;">114</td>
<td>I Need You</td>
<td>1965</td>
<td>Help!</td>
<td>148</td>
<td>11</td>
<td>Pop/Rock</td>
<td>Harrison</td>
<td>Harrison</td>
<td>-1</td>
</tr>
<tr class="even">
<td style="text-align: center;">261</td>
<td>The Night Before</td>
<td>1965</td>
<td>Help!</td>
<td>153</td>
<td>13</td>
<td>Electronic Pop/Rock</td>
<td>McCartney</td>
<td>McCartney</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">270</td>
<td>Ticket to Ride</td>
<td>1965</td>
<td>Help!</td>
<td>190</td>
<td>31</td>
<td>Power Pop, Jangle Pop, Folk Rock, Pop/Rock</td>
<td>Lennon</td>
<td>Lennon, with McCartney</td>
<td>17</td>
</tr>
<tr class="even">
<td style="text-align: center;">305</td>
<td>You’re Going to Lose That Girl</td>
<td>1965</td>
<td>Help!</td>
<td>140</td>
<td>6</td>
<td>Rock, Pop/Rock</td>
<td>Lennon</td>
<td>Lennon</td>
<td>-1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">306</td>
<td>You’ve Got to Hide Your Love Away</td>
<td>1965</td>
<td>Help!</td>
<td>131</td>
<td>12</td>
<td>FolkPop/Rock</td>
<td>Lennon</td>
<td>Lennon</td>
<td>-1</td>
</tr>
</tbody>
</table>
</details>
<p>The result stored in help is a dataframe! You could perform any operation on help that you would on a dataframe.</p>
<p><a name="more-ways-to-use-groupby" href=""></a> ### More ways to use groupby</p>
<p>Since groupby is such a powerful but complex tool, it may be helpful to learn more about the various ways to use it.</p>
</section>
</section>
<section id="using-transform-with-groupby-to-create-new-columns-in-your-existing-dataframe" class="level4">
<h4 class="anchored" data-anchor-id="using-transform-with-groupby-to-create-new-columns-in-your-existing-dataframe">Using <code>transform()</code> with Groupby to Create New Columns in your Existing DataFrame</h4>
<p>So far we have seen various ways to aggregate data using groupby. Each of these returns a dataframe that is shaped very different from our original. But what if you wanted to derive some data about groups of objects that are then added to the original set? We do this with <code>transform()</code>.</p>
<p>For example, let’s say we want to filter out of our dataset all genres that appear only <strong>once</strong>. We could do this by getting the <code>df.value_counts()</code> then, filtering that list, and finally using that short list to test for values in our genre column, with <code>isin([])</code>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explode the genre column to get each genre in its own row</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>beatles_exploded <span class="op">=</span> beatles_billboard.explode(<span class="st">'Genre'</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get the value counts of the genre column</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>genre_counts <span class="op">=</span> beatles_exploded[<span class="st">'Genre'</span>].value_counts()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># filter the value counts to only those that appear more than once</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>common_genres <span class="op">=</span> genre_counts[genre_counts <span class="op">&gt;</span> <span class="dv">1</span>].index</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># filter the original dataframe to only those genres that appear more than once</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>beatles_exploded_common_genres <span class="op">=</span> beatles_exploded[beatles_exploded[<span class="st">'Genre'</span>].isin(common_genres)]</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>beatles_exploded_common_genres.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But another way to do this would be with <code>groupby</code> and <code>transform()</code>, reporting the resulting count for each genre value to a new column in the original dataset and then filtering those out. Here is how:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># groupby the genre column and transform to get the count of each genre</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>beatles_exploded <span class="op">=</span> beatles_billboard.explode(<span class="st">'Genre'</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>beatles_exploded[<span class="st">'genre_count'</span>] <span class="op">=</span> beatles_exploded.groupby(<span class="st">'genre'</span>)[<span class="st">'genre'</span>].transform(<span class="st">'count'</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter out the genres that appear only once</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>beatles_exploded_common_genres <span class="op">=</span> beatles_exploded[beatles_exploded[<span class="st">'genre_count'</span>] <span class="op">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>beatles_exploded_common_genres.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="using-categorical-data---lambda-functions-and-applylist" class="level4">
<h4 class="anchored" data-anchor-id="using-categorical-data---lambda-functions-and-applylist">Using Categorical Data - Lambda Functions and <code>apply(list)</code></h4>
<p>So far, the aggregations methods explored have been applied to numerical data. However, we can also use categorical data with groupby. This section will explore function calls: lambda functions and <code>apply(list)</code>. While neither of these are aggregation functions, they can be extremely useful in transforming and analyzing our data, especially categorical data.</p>
<section id="lambda-functions-and-.apply" class="level5">
<h5 class="anchored" data-anchor-id="lambda-functions-and-.apply">Lambda Functions and <code>.apply()</code></h5>
<p><code>.apply()</code> takes a data structure and applies a function to it. For example, you could make a new column in a dataframe with a Boolean value. In this example, we’ll check if a given track in Help! made it in the top 50 billboard.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the group for the album Help!</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span> <span class="op">=</span> grouped.get_group(<span class="st">'Help!'</span>) </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up a boolean function</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_top_50(track_rank) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Function to check if a track is in the top 50.</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> track_rank <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the function to the help group</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>[<span class="st">'is_top_50'</span>] <span class="op">=</span> <span class="bu">help</span>[<span class="st">'Top.50.Billboard'</span>].<span class="bu">apply</span>(is_top_50)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<div>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
Title
</th>
<th>
Year
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Songwriter
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
<th>
is_top_50
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
16
</th>
<td>
Another Girl
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
124
</td>
<td>
9
</td>
<td>
Country Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
92
</th>
<td>
Help!
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
138
</td>
<td>
34
</td>
<td>
Folk Rock, Pop/Rock
</td>
<td>
Lennon, with McCartney
</td>
<td>
Lennon
</td>
<td>
14
</td>
<td>
True
</td>
</tr>
<tr>
<th>
114
</th>
<td>
I Need You
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
148
</td>
<td>
11
</td>
<td>
Pop/Rock
</td>
<td>
Harrison
</td>
<td>
Harrison
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
261
</th>
<td>
The Night Before
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
153
</td>
<td>
13
</td>
<td>
Electronic Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
270
</th>
<td>
Ticket to Ride
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
190
</td>
<td>
31
</td>
<td>
Power Pop, Jangle Pop, Folk Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon, with McCartney
</td>
<td>
17
</td>
<td>
True
</td>
</tr>
<tr>
<th>
305
</th>
<td>
You’re Going to Lose That Girl
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
140
</td>
<td>
6
</td>
<td>
Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
306
</th>
<td>
You’ve Got to Hide Your Love Away
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
131
</td>
<td>
12
</td>
<td>
FolkPop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
</tbody>
</table>
</div>
</details>
<p>However, many functions are small enough that they can be defined without a name - these are called lambda functions! The code below shows how to use a lambda function to do the same thing as the is_top_50 function above.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the group for the album Help!</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span> <span class="op">=</span> grouped.get_group(<span class="st">'Help!'</span>) </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use a lambda function to apply the is_top_50 function</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>[<span class="st">'is_top_50'</span>] <span class="op">=</span> <span class="bu">help</span>[<span class="st">'Top.50.Billboard'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<div>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
Title
</th>
<th>
Year
</th>
<th>
Album.debut
</th>
<th>
Duration
</th>
<th>
Other.releases
</th>
<th>
Genre
</th>
<th>
Songwriter
</th>
<th>
Lead.vocal
</th>
<th>
Top.50.Billboard
</th>
<th>
is_top_50
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
16
</th>
<td>
Another Girl
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
124
</td>
<td>
9
</td>
<td>
Country Rock, Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
92
</th>
<td>
Help!
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
138
</td>
<td>
34
</td>
<td>
Folk Rock, Pop/Rock
</td>
<td>
Lennon, with McCartney
</td>
<td>
Lennon
</td>
<td>
14
</td>
<td>
True
</td>
</tr>
<tr>
<th>
114
</th>
<td>
I Need You
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
148
</td>
<td>
11
</td>
<td>
Pop/Rock
</td>
<td>
Harrison
</td>
<td>
Harrison
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
261
</th>
<td>
The Night Before
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
153
</td>
<td>
13
</td>
<td>
Electronic Pop/Rock
</td>
<td>
McCartney
</td>
<td>
McCartney
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
270
</th>
<td>
Ticket to Ride
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
190
</td>
<td>
31
</td>
<td>
Power Pop, Jangle Pop, Folk Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon, with McCartney
</td>
<td>
17
</td>
<td>
True
</td>
</tr>
<tr>
<th>
305
</th>
<td>
You’re Going to Lose That Girl
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
140
</td>
<td>
6
</td>
<td>
Rock, Pop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
<tr>
<th>
306
</th>
<td>
You’ve Got to Hide Your Love Away
</td>
<td>
1965
</td>
<td>
Help!
</td>
<td>
131
</td>
<td>
12
</td>
<td>
FolkPop/Rock
</td>
<td>
Lennon
</td>
<td>
Lennon
</td>
<td>
-1
</td>
<td>
False
</td>
</tr>
</tbody>
</table>
</div>
</details>
<p>Since we are already defining the column of interest, we can simply write <code>lambda x: x &gt; 0</code>, and it will check if the value from the Top.50.Billboard column (<em>written as x, but could be any name</em>) is greater than 0 for each row, automatically entering the boolean response into is_top_50.</p>
</section>
<section id="using-.applylist-with-dataframes" class="level5">
<h5 class="anchored" data-anchor-id="using-.applylist-with-dataframes">Using <code>.apply(list)</code> with dataframes</h5>
<p>Now we’re going to use the <code>list</code> function as an aggregation function, to work with genres and songs. Let’s say we wanted a list of albums containing each Beatles genre.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we need to clean the data</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard[<span class="st">'Genre'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.strip().fillna(<span class="st">''</span>) </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>beatles_billboard[<span class="st">'Genre'</span>] <span class="op">=</span> beatles_billboard[<span class="st">'Genre'</span>].<span class="bu">str</span>.split(<span class="st">', '</span>) </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, we need to explode the 'Genre' column</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>beatles_exploded <span class="op">=</span> beatles_billboard.explode(<span class="st">'Genre'</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>beatles_exploded</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can group by 'Genre' and aggregate the 'Title' column into a list</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>grouped_list <span class="op">=</span> beatles_exploded.groupby(<span class="st">'Genre'</span>)[<span class="st">'Album.debut'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co"># But, this will have duplicates since multiple songs in each album can have the same genre tag. </span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># So, we'll have to combine this with a lambda function to remove duplicates - we can just use the built in "pd.unique".</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>grouped_list <span class="op">=</span> beatles_exploded.groupby(<span class="st">'Genre'</span>)[<span class="st">'Album.debut'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">list</span>(pd.unique(x)))</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>grouped_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>Genre
                   [Let It Be... Naked - Fly on the Wall bonus di...
acid rock                   [Magical Mystery Tour, Yellow Submarine]
acid rock[                                                [Revolver]
art pop                           [Magical Mystery Tour, Abbey Road]
art rock           [Sgt. Pepper's Lonely Hearts Club Band, Revolv...
                                         ...                        
stage&amp;screen            [UK: Please Please Me US: The Early Beatles]
sunshine pop                                              [Revolver]
swamp pop                                               [Abbey Road]
symphonic rock                                          [Abbey Road]
vaudeville rock                               [Magical Mystery Tour]
Name: Album.debut, Length: 81, dtype: object</code></pre>
</details>
<p>Or, if we wanted to zoom in a little, we could get a list of every album containing a certain genre, like “psychedelic rock”. The column that we group by serves as an index, so I can simply call it in the list.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>grouped_list[<span class="st">"psychedelic rock"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Output
</summary>
<pre><code>["Sgt. Pepper's Lonely Hearts Club Band",
 'Magical Mystery Tour',
 'UK: Revolver US: Yesterday and Today',
 'The Beatles',
 'Yellow Submarine',
 'Revolver',
 'UK: A Collection of Beatles Oldies US: Hey Jude',
 'UK: Rarities US: Hey Jude',
 nan,
 'Anthology 3']</code></pre>
</details>
</section>
</section>
<section id="performing-groupby-on-several-columns" class="level4">
<h4 class="anchored" data-anchor-id="performing-groupby-on-several-columns">Performing groupby on several columns</h4>
<p>What if I want to groupby on several columns?</p>
<p>Performing a groupby operation on several columns at once if you want to create subgroups within a group. For example:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode py code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>album_vocal <span class="op">=</span> beatles_billboard.groupby([<span class="st">'Album.debut'</span>, <span class="st">'Lead.vocal'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then any operation you perform will be performed on the subgroup of ‘Lead.vocal’ within the larger ‘Album.debut’ group.</p>
<p>Note that using groupby with several grouping columns will complicate the operations you perform later. Use the documentation!</p>
<p><br></p>
<table class="caption-top">
<thead>
<tr class="header">
<th><a href="04_Pandas_Basics.md">Pandas Basics</a></th>
<th><a href="05_Pandas_Clean_Data.md">Clean Data</a></th>
<th><a href="06_Pandas_Tidy_Data.md">Tidy Data</a></th>
<th><strong>Filtering, Finding, and Grouping</strong></th>
<th><a href="08_Pandas_Graphs_and_Charts.md">Graphs and Charts</a></th>
<th><a href="09_Pandas_Networks.md">Networks</a></th>
</tr>
</thead>

</table>
</section>
</section>
</section>
<section id="credits-and-license" class="level2">
<h2 class="anchored" data-anchor-id="credits-and-license">Credits and License</h2>
<p>Resources from <strong>Music 255: Encoding Music</strong>, a course taught at Haverford College by Professor Richard Freedman.</p>
<p>Special thanks to Haverford College students Charlie Cross, Owen Yaggy, Harrison West, Edgar Leon and Oleh Shostak for indispensable help in developing the course, the methods and documentation.</p>
<p>Additional thanks to Anna Lacy and Patty Guardiola of the Digital Scholarship team of the Haverford College libraries, to Adam Portier, systems administrator in the IITS department, and to Dr Daniel Russo-Batterham, Melbourne University.</p>
<p>This work is licensed under CC BY-NC-SA 4.0</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>